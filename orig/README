# Download data files
(seq 22; echo X) | xargs printf \
"http://cdna.eva.mpg.de/neandertal/Vindija/VCF/Vindija33.19/chr%s_mq25_mapab100.vcf.gz\n" \
| xargs -n 1 wget

# Download checksum file
wget "http://cdna.eva.mpg.de/neandertal/Vindija/VCF/Vindija33.19/md5sums.txt"

# Check checksums. All checksums are fine.
md5sum -c md5sums.txt 

# Filter data files
(seq 22; echo X) | xargs -P 15 -n 1 bash filter.sh

# Add ancestral (AA) annotations
(seq 22; echo X) | xargs -P 15 -n 1 bash ancall.sh

# Index data files
ls *-aa.bcf | xargs -P 15 -n 1 tabix

# Generate .daf file.
seq 22 | sort | xargs -n 1 printf "vindija-chr%s-aa.bcf\n" | \
xargs -n 1 bcftools query -f '%CHROM\t%POS\t%REF\t%ALT\t%INFO/AA[\t%GT]\n' | \
daf > vindija.daf

# Refs on ancestral alleles
ftp://ftp.ncbi.nih.gov/snp/database/organism_data/human_9606/SNPAncestralAllele.bcp.gz



